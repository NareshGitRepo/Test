<div id="page-title">
  <h2>{{'EmpPerformanceModule.manage.title' | translate}}</h2>
  </div>

 <form [formGroup]="empForm">
  <div fxLayout="row wrap">
  <div fxFlex.gt-sm="13" fxFlex="100">
    <mat-form-field class="w100 pad-rgt">
      <mat-select placeholder="{{'EmpPerformanceModule.manage.selectFloor' | translate}}" formControlName="floor" (selectionChange)="loadDepartments($event.value)"  multiple>
        <mat-option #allFloorSelected [value]="0" (click)="toggleAllSelection('floor')">{{'EmpPerformanceModule.manage.allFloors' | translate}}</mat-option>
        <mat-option [value]="floor.floorId" *ngFor="let floor of levellist" (click)="togglePerOne('floor')">{{floor.floorName}}</mat-option>
      </mat-select>
    </mat-form-field>
  </div>

  <div fxFlex.gt-sm="13" fxFlex="100">
    <mat-form-field class="w100 pad-rgt" >
      <mat-select placeholder="{{'EmpPerformanceModule.manage.selectDepartment' | translate}}" formControlName="department" multiple>
          <mat-option #allDeptSelected [value]="0" (click)="toggleAllSelection('department')">{{'EmpPerformanceModule.manage.allDeptartments' | translate}}</mat-option>
      <mat-optgroup *ngFor="let floor of filterGroup" [label]="floor.floorName">

        <mat-option [value]="dept.deptId" *ngFor="let dept of floor.departments" (click)="togglePerOne('department')">{{dept.deptName}}</mat-option>
      </mat-optgroup>
      </mat-select>
    </mat-form-field>
  </div>

  <div fxFlex.gt-sm="13" fxFlex="100">
    <mat-form-field class="w100 pad-rgt">
      <mat-select placeholder="{{'EmpPerformanceModule.manage.selectPeriod' | translate}}" formControlName="selectValue" (selectionChange)="selectPeriod($event.value)" required>
        <mat-option [value]="period.key" *ngFor="let period of selPeriods | keyvalue">{{period.value}}</mat-option>
      </mat-select>
    </mat-form-field>
  </div>

  <div fxFlex.gt-sm="13" fxFlex="100" *ngIf="year">

           <mat-form-field class="w100 pad-rgt" >
            <mat-select placeholder="{{'EmpPerformanceModule.manage.selectYear' | translate}}" formControlName="year" (selectionChange)="selectedYear()" required>
              <mat-option [value]="year" *ngFor="let year of years">{{year}}</mat-option>
            </mat-select>
          </mat-form-field>

  </div>

  <div fxFlex.gt-sm="13" fxFlex="100" *ngIf="Quarter">

              <mat-form-field class="w100 pad-rgt">
                  <mat-select placeholder="{{'EmpPerformanceModule.manage.selectQuarter' | translate}}" formControlName="quarters" required>
                      <mat-option value="1">1st</mat-option>
                    <mat-option value="2">2nd</mat-option>
                    <mat-option value="3">3rd</mat-option>
                    <mat-option value="4">4th</mat-option>
                  </mat-select>
                </mat-form-field>

  </div>

  <div fxFlex.gt-sm="13" fxFlex="100" *ngIf="month">
      <mat-form-field  class="w100 pad-rgt" >
         <mat-select placeholder="{{'EmpPerformanceModule.manage.selectMonth' | translate}}" formControlName="month" (selectionChange)="selectedMonth()" required>
              <mat-option [value]="month.monthId" *ngFor="let month of months">{{month.monthName}}</mat-option>
            </mat-select>
        </mat-form-field>
<mat-error *ngIf=""></mat-error>

  </div>

  <div fxFlex.gt-sm="13" fxFlex="100" *ngIf="week">

              <mat-form-field class="w100 pad-rgt">
                  <mat-select placeholder="{{'EmpPerformanceModule.manage.selectWeek' | translate}}" formControlName="weeks" required>
                    <mat-option [value]="week" *ngFor="let week of weeks; let i=index ">{{weekData[i]}}</mat-option>
                  </mat-select>
                </mat-form-field>

  </div>

  <div fxFlex.gt-sm="30" fxFlex="100"  *ngIf="Date">
      <div fxLayout="row wrap">
        <div fxFlex="50">
           <mat-form-field  class="w100 pad-rgt">
        <input matInput [matDatepicker]="picker6" formControlName="fromDate" placeholder="{{'EmpPerformanceModule.manage.from' | translate}}"
        [min]="startDate" [max]="empForm.value.toDate ? empForm.value.toDate : endDate" required>
        <mat-datepicker-toggle matSuffix [for]="picker6"></mat-datepicker-toggle>
        <mat-datepicker #picker6></mat-datepicker>
      </mat-form-field>
        </div>
        <div fxFlex="50">
            <mat-form-field  class="w100 pad-rgt">
                <input matInput [matDatepicker]="picker7" formControlName="toDate" placeholder="{{'EmpPerformanceModule.manage.to' | translate}}"
                [min]="empForm.value.fromDate ? empForm.value.fromDate : startDate"
                [max]="endDate" required>
                <mat-datepicker-toggle matSuffix [for]="picker7"></mat-datepicker-toggle>
                <mat-datepicker #picker7></mat-datepicker>
              </mat-form-field>
        </div>

  </div>


  </div>

  <div fxFlex.gt-sm="25" fxFlex="100">
    <button mat-raised-button color="primary" (click)="getReports()" [disabled]="empForm.invalid">{{'ActionNames.submit' | translate}}</button> &nbsp;
    <button  mat-raised-button type="reset" (click)="clearAllFields()">{{'ActionNames.clear' | translate}}</button>
  </div>

  <div fxFlex.gt-sm="13" fxFlex="100">
  <div class="clearfix mar-btm">
    <div class="pull-left">
      <button class="btn pull-right btn-yellow" [matMenuTriggerFor]="SearchGrid"
        *ngIf="reportsList.length>0 && false">{{'EmpPerformanceModule.manage.export' | translate}}
        <i class="ti-angle-down"></i>
      </button> &nbsp;
      <mat-menu #SearchGrid="matMenu">

        <button mat-menu-item (click)="ExportTOExcel()">
          <i class="ti-file"></i> {{'EmpPerformanceModule.manage.excel' | translate}}</button>
        <button mat-menu-item (click)="ExportTOCsv()">
          <i class="ti-file"></i> {{'EmpPerformanceModule.manage.csv' | translate}}</button>
      </mat-menu>
    </div>


  </div></div></div>
</form>
<br>

<div class="mat-elevation-z8" *ngIf="reportsList.length">
  <h4 class="title pad-lft pad-top">{{'EmpPerformanceModule.manage.from' | translate}}: {{fromDate}} {{'EmpPerformanceModule.manage.to' | translate}}: {{toDate}}</h4>
        <mat-table #table [dataSource]="dataSource" matSort (matSortChange)="sortData()">

            <!--- Note that these columns can be defined in any order.
                  The actual rendered columns are set as a property on the row definition" -->

            <!-- Position Column -->
            <ng-container matColumnDef="staff_Name">
              <mat-header-cell *matHeaderCellDef mat-sort-header class="pad-all">{{'EmpPerformanceModule.manage.staffName' | translate}}</mat-header-cell>
              <mat-cell *matCellDef="let element" class="pad-all"> {{element.staff_Name}} </mat-cell>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="loginId">
              <mat-header-cell *matHeaderCellDef mat-sort-header class="pad-all"> {{'EmpPerformanceModule.manage.staffId' | translate}} </mat-header-cell>
              <mat-cell *matCellDef="let element" class="pad-all"> {{element.loginId}} </mat-cell>
            </ng-container>

            <!-- Weight Column -->
            <ng-container matColumnDef="avg_Idle_Time">
              <mat-header-cell *matHeaderCellDef mat-sort-header class="pad-all"> {{'EmpPerformanceModule.manage.avgIdleTime' | translate}} </mat-header-cell>
              <mat-cell *matCellDef="let element" class="pad-all"> {{element.avg_Idle_Time | dformatTime }} <small>(hh:mm)</small>  </mat-cell>
            </ng-container>

            <!-- Symbol Column -->
            <ng-container matColumnDef="avg_Serve_Time" >
              <mat-header-cell *matHeaderCellDef mat-sort-header class="pad-all"> {{'EmpPerformanceModule.manage.avgServingTime' | translate}}</mat-header-cell>
              <mat-cell *matCellDef="let element" class="pad-all"> {{element.avg_Serve_Time | dformatTime }} <small>(hh:mm)</small>  </mat-cell>
            </ng-container>

            <ng-container matColumnDef="total_Serve_Time" >
                <mat-header-cell *matHeaderCellDef mat-sort-header class="pad-all"> {{'EmpPerformanceModule.manage.totalServingTime' | translate}}</mat-header-cell>
                <mat-cell *matCellDef="let element" class="pad-all"> {{element.total_Serve_Time | dformatTime }} <small>(hh:mm)</small> </mat-cell>
              </ng-container>

              <ng-container matColumnDef="total_Token_Serve" >
                  <mat-header-cell *matHeaderCellDef mat-sort-header class="pad-all"> {{'EmpPerformanceModule.manage.tokensServed' | translate}} </mat-header-cell>
                  <mat-cell *matCellDef="let element" class="pad-all"> {{element.total_Token_Serve}} </mat-cell>
                </ng-container>

            <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
            <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
          </mat-table>
          <div *ngIf="reportsList.length > pageSize" style="width: 100%">
            <mat-paginator [length]="reportsList.length" [pageSize]="pageSize" [pageIndex]="listPage" showFirstLastButtons
              (page)="getListData($event)">
            </mat-paginator>
          </div>


        </div><div *ngIf="gridLoad"><span>{{'EmpPerformanceModule.manage.noData' | translate}}</span></div>
        <div class="fullloader" *ngIf="loading">
          <div class="fullloaderInner">
            <img src="assets/images/loading.gif">
          </div>
        </div>
